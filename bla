
SELECT Incident.name, Person.name, Person.age, Person.gender, Criminal.no_of_crimes
FROM Disaster, Incident, Criminal, Person, Report
    WHERE Disaster.id=Incident.type 
    and Incident.suspect = Criminal.id 
    and Incident.id = Report.incident_id 
    and Criminal.id = Person.id 

    -- can be removed (i.e. no OTHERS here)
    and Person.gender IN (0,1)

    and Disaster.id IN (
        SELECT Disaster.id
        FROM Disaster, Incident
        WHERE Disaster.id=Incident.type and Incident.eco_loss < 50000 
    )

    -- can be removed (i.e. no Government Representatives less than or equal 10 years old)
    and Report.govn_id IN (
        SELECT Government_Representative.id
        FROM Government_Representative, Person
        WHERE Person.id=Government_Representative.id and (Person.age > 10 )
    )

    -- can be removed (i.e. trust levels are of maximum = 10)
    and Report.citizen_id IN (
        SELECT Citizen.id
        FROM Citizen
        WHERE (Citizen.trust_level <= 10)
    )
ORDER BY Incident.name
;


-- optimized on old schema
SELECT Incident.name, Person.name, Person.age, Person.gender, Criminal.no_of_crimes
FROM Disaster, Incident, Criminal, Person, Report
    WHERE Disaster.id=Incident.type 
    and Incident.suspect = Criminal.id 
    and Incident.id = Report.incident_id 
    and Criminal.id = Person.id 

    and Disaster.id IN (
        SELECT Disaster.id
        FROM Disaster, Incident
        WHERE Disaster.id=Incident.type and Incident.eco_loss < 50000 
    )
ORDER BY Incident.name
;

-- Create  Indexes
CREATE INDEX Criminal_no_crimes_Idx ON Criminal(no_of_crimes);
CREATE INDEX Incident_name_Idx ON Incident(name);


-- optimized on new schema
SELECT Incident.name, Criminal.name, Criminal.age, Criminal.gender, Criminal.no_of_crimes
FROM Disaster, Incident, Criminal, Report
    WHERE Disaster.id=Incident.type 
    and Incident.suspect = Criminal.id 
    and Incident.id = Report.incident_id 

    and Disaster.id IN (
        SELECT Disaster.id
        FROM Disaster, Incident
        WHERE Disaster.id=Incident.type and Incident.eco_loss < 50000 
    )
ORDER BY Incident.name
;

-- Drop Indexes
DROP INDEX Criminal_no_crimes_Idx ON Criminal;
DROP INDEX Incident_name_Idx ON Incident;

